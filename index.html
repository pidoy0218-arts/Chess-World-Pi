<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chess Arena Pi</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #111;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
    }

    h1 {
      margin: 15px;
    }

    #soundToggle {
      margin: 10px;
      cursor: pointer;
    }

    .board {
      display: grid;
      grid-template-columns: repeat(8, 60px);
      grid-template-rows: repeat(8, 60px);
      margin: auto;
      border: 2px solid white;
    }

    .cell {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 36px;
      cursor: pointer;
    }

    .light {
      background: #d0f0c0;
    }

    .dark {
      background: #3a5f0b;
    }

    .highlight {
      background-color: #9acd32 !important;
    }
  </style>
</head>
<body>
  <h1>‚ôü Chess Arena Pi</h1>
  <div id="soundToggle">üîä Sound: ON</div>
  <div class="board" id="board"></div>

  <audio id="moveSound" src="https://upload.wikimedia.org/wikipedia/commons/8/89/Chess_move_sound.ogg"></audio>

  <script>
    const board = document.getElementById("board");
    const moveSound = document.getElementById("moveSound");
    let soundEnabled = true;

    document.getElementById("soundToggle").onclick = () => {
      soundEnabled = !soundEnabled;
      document.getElementById("soundToggle").textContent = soundEnabled ? "üîä Sound: ON" : "üîá Sound: OFF";
    };

    const initialBoard = [
      ["‚ôú","‚ôû","‚ôù","‚ôõ","‚ôö","‚ôù","‚ôû","‚ôú"],
      ["‚ôü","‚ôü","‚ôü","‚ôü","‚ôü","‚ôü","‚ôü","‚ôü"],
      ["","","","","","","",""],
      ["","","","","","","",""],
      ["","","","","","","",""],
      ["","","","","","","",""],
      ["‚ôô","‚ôô","‚ôô","‚ôô","‚ôô","‚ôô","‚ôô","‚ôô"],
      ["‚ôñ","‚ôò","‚ôó","‚ôï","‚ôî","‚ôó","‚ôò","‚ôñ"]
    ];

    let gameState = JSON.parse(JSON.stringify(initialBoard));
    let selected = null;
    let turn = "white";

    const pieceColor = (p) => {
      if ("‚ôô‚ôò‚ôó‚ôñ‚ôï‚ôî".includes(p)) return "white";
      if ("‚ôü‚ôû‚ôù‚ôú‚ôõ‚ôö".includes(p)) return "black";
      return null;
    };

    const directions = {
      rook:  [[1,0],[-1,0],[0,1],[0,-1]],
      bishop:[[1,1],[1,-1],[-1,1],[-1,-1]],
      queen: [[1,0],[-1,0],[0,1],[0,-1],[1,1],[1,-1],[-1,1],[-1,-1]]
    };

    const getValidMoves = (r, c, piece) => {
      const moves = [];
      const color = pieceColor(piece);
      const dir = color === "white" ? -1 : 1;
      const opp = color === "white" ? "black" : "white";

      if (piece === "‚ôô" || piece === "‚ôü") {
        if (!gameState[r+dir]?.[c]) moves.push([r+dir,c]);
        if ((color === "white" && r === 6 || color === "black" && r === 1) &&
            !gameState[r+dir]?.[c] && !gameState[r+2*dir]?.[c]) {
          moves.push([r+2*dir, c]);
        }
        for (let dc of [-1,1]) {
          const target = gameState[r+dir]?.[c+dc];
          if (target && pieceColor(target) === opp) moves.push([r+dir, c+dc]);
        }
      }

      if (piece === "‚ôò" || piece === "‚ôû") {
        for (let [dr, dc] of [[-2,-1],[-2,1],[-1,-2],[-1,2],[1,-2],[1,2],[2,-1],[2,1]]) {
          const nr = r + dr, nc = c + dc;
          if (nr >= 0 && nr < 8 && nc >= 0 && nc < 8) {
            const target = gameState[nr][nc];
            if (!target || pieceColor(target) === opp) moves.push([nr, nc]);
          }
        }
      }

      if (piece === "‚ôñ" || piece === "‚ôú") {
        for (let [dr, dc] of directions.rook) {
          for (let i = 1; i < 8; i++) {
            const nr = r + dr*i, nc = c + dc*i;
            if (nr < 0 || nr > 7 || nc < 0 || nc > 7) break;
            const target = gameState[nr][nc];
            if (!target) moves.push([nr, nc]);
            else {
              if (pieceColor(target) === opp) moves.push([nr, nc]);
              break;
            }
          }
        }
      }

      if (piece === "‚ôó" || piece === "‚ôù") {
        for (let [dr, dc] of directions.bishop) {
          for (let i = 1; i < 8; i++) {
            const nr = r + dr*i, nc = c + dc*i;
            if (nr < 0 || nr > 7 || nc < 0 || nc > 7) break;
            const target = gameState[nr][nc];
            if (!target) moves.push([nr, nc]);
            else {
              if (pieceColor(target) === opp) moves.push([nr, nc]);
              break;
            }
          }
        }
      }

      if (piece === "‚ôï" || piece === "‚ôõ") {
        for (let [dr, dc] of directions.queen) {
          for (let i = 1; i < 8; i++) {
            const nr = r + dr*i, nc = c + dc*i;
            if (nr < 0 || nr > 7 || nc < 0 || nc > 7) break;
            const target = gameState[nr][nc];
            if (!target) moves.push([nr, nc]);
            else {
              if (pieceColor(target) === opp) moves.push([nr, nc]);
              break;
            }
          }
        }
      }

      if (piece === "‚ôî" || piece === "‚ôö") {
        for (let [dr, dc] of directions.queen) {
          const nr = r + dr, nc = c + dc;
          if (nr >= 0 && nr < 8 && nc >= 0 && nc < 8) {
            const target = gameState[nr][nc];
            if (!target || pieceColor(target) === opp) moves.push([nr,nc]);
          }
        }
      }

      return moves;
    };

    function drawBoard() {
      board.innerHTML = "";
      for (let r = 0; r < 8; r++) {
        for (let c = 0; c < 8; c++) {
          const cell = document.createElement("div");
          cell.className = "cell " + ((r+c)%2===0 ? "light" : "dark");
          cell.dataset.r = r;
          cell.dataset.c = c;
          cell.textContent = gameState[r][c];
          board.appendChild(cell);
        }
      }
    }

    function highlightMoves(moves) {
      for (let cell of document.querySelectorAll(".cell")) {
        const r = +cell.dataset.r, c = +cell.dataset.c;
        if (moves.some(m => m[0] === r && m[1] === c)) {
          cell.classList.add("highlight");
        }
      }
    }

    board.addEventListener("click", (e) => {
      const r = +e.target.dataset.r;
      const c = +e.target.dataset.c;
      const piece = gameState[r][c];

      if (selected) {
        const [sr, sc, spiece] = selected;
        const moves = getValidMoves(sr, sc, spiece);
        if (moves.some(([mr, mc]) => mr === r && mc === c)) {
          gameState[r][c] = spiece;
          gameState[sr][sc] = "";
          selected = null;
          turn = turn === "white" ? "black" : "white";
          if (soundEnabled) moveSound.play();
          drawBoard();
          return;
        }
        selected = null;
        drawBoard();
        return;
      }

      if (piece && pieceColor(piece) === turn) {
        selected = [r, c, piece];
        drawBoard();
        highlightMoves(getValidMoves(r, c, piece));
      }
    });

    drawBoard();
  </script>
</body>
</html>
